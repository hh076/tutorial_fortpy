// ====================================================================
//
//      Hiroaki HONDA, Yu-ichi INADOMI, and Jun MAKI
//
//      All rights reserved since Aug. 21th 2008.
//      RHF Part of OpenFMO project: http://www.openfmo.org
//      Correspondence: dahon@soc.ait.kyushu-u.ac.jp
// ====================================================================

#include <stdio.h>
#include "PSI_stan.h"
#include "PSI_def_int.h"
#include "PSI_proto_int1.h"

// ====================================================================
// ====================================================================
// ====================================================================

static int NCOMPTBL[ ] = {
    1, 3, 6, 10, 15, 28, 0, 0 } ;

static int IDXDFCT[ ] = {
    0, 1, 4, 10, 20, 35, 56, 84 } ;

static double DFCTTBL[ ] = {
    1.0000000000000000e+00,
    ///
    1.0000000000000000e+00, 1.0000000000000000e+00, 1.0000000000000000e+00,
    1.0000000000000000e+00, 1.0000000000000000e+00, 1.0000000000000000e+00,
    1.7320508075688772e+00, 1.7320508075688772e+00, 1.7320508075688772e+00,
    ///
    1.0000000000000000e+00, 1.0000000000000000e+00, 1.0000000000000000e+00,
    2.2360679774997898e+00, 2.2360679774997898e+00, 2.2360679774997898e+00,
    2.2360679774997898e+00, 2.2360679774997898e+00, 2.2360679774997898e+00,
    3.8729833462074170e+00,
    ///
    1.0000000000000000e+00, 1.0000000000000000e+00, 1.0000000000000000e+00,
    2.6457513110645907e+00, 2.6457513110645907e+00, 2.6457513110645907e+00,
    3.3166247903553998e+00, 3.3166247903553998e+00, 3.3166247903553998e+00,
    2.6457513110645907e+00, 2.6457513110645907e+00, 2.6457513110645907e+00,
    5.9160797830996161e+00, 5.9160797830996161e+00, 5.9160797830996161e+00,
    ///
    1.0000000000000000e+00, 1.0000000000000000e+00, 1.0000000000000000e+00,
    3.0000000000000000e+00, 3.0000000000000000e+00, 3.0000000000000000e+00,
    4.5825756949558398e+00, 4.5825756949558398e+00, 4.5825756949558398e+00,
    4.5825756949558398e+00, 4.5825756949558398e+00, 4.5825756949558398e+00,
    3.0000000000000000e+00, 3.0000000000000000e+00, 3.0000000000000000e+00,
    7.9372539331937721e+00, 7.9372539331937721e+00, 7.9372539331937721e+00,
    1.0246950765959598e+01, 1.0246950765959598e+01, 1.0246950765959598e+01,
    ///
    1.0000000000000000e+00, 1.0000000000000000e+00, 1.0000000000000000e+00,
    3.3166247903553998e+00, 3.3166247903553998e+00, 3.3166247903553998e+00,
    5.7445626465380286e+00, 5.7445626465380286e+00, 5.7445626465380286e+00,
    6.7823299831252681e+00, 6.7823299831252681e+00, 6.7823299831252681e+00,
    5.7445626465380286e+00, 5.7445626465380286e+00, 5.7445626465380286e+00,
    3.3166247903553998e+00, 3.3166247903553998e+00, 3.3166247903553998e+00,
    9.9498743710661994e+00, 9.9498743710661994e+00, 9.9498743710661994e+00,
    1.5198684153570664e+01, 1.5198684153570664e+01, 1.5198684153570664e+01,
    1.5198684153570664e+01, 1.5198684153570664e+01, 1.5198684153570664e+01,
    1.9621416870348583e+01,
    ///
    1.0000000000000000e+00, 1.0000000000000000e+00, 1.0000000000000000e+00,
    3.6055512754639891e+00, 3.6055512754639891e+00, 3.6055512754639891e+00,
    6.8556546004010439e+00, 6.8556546004010439e+00, 6.8556546004010439e+00,
    9.2195444572928871e+00, 9.2195444572928871e+00, 9.2195444572928871e+00,
    9.2195444572928871e+00, 9.2195444572928871e+00, 9.2195444572928871e+00,
    6.8556546004010439e+00, 6.8556546004010439e+00, 6.8556546004010439e+00,
    3.6055512754639891e+00, 3.6055512754639891e+00, 3.6055512754639891e+00,
    1.1958260743101398e+01, 1.1958260743101398e+01, 1.1958260743101398e+01,
    2.0712315177207980e+01, 2.0712315177207980e+01, 2.0712315177207980e+01,
    2.4494897427831781e+01, 2.4494897427831781e+01, 2.4494897427831781e+01,
    2.0712315177207980e+01, 2.0712315177207980e+01, 2.0712315177207980e+01,
    3.1638584039112750e+01, 3.1638584039112750e+01, 3.1638584039112750e+01 } ;

static int
save_and_mul_fact1 ( int inttype, int la, int lb,
                     int *addr_fact, double *dint_from, double *dint_to )
{
    int ia, ib, ic, id ;
    int addr_a, addr_b, addr_c, addr_ab ;
    int addr_from, addr_to ;
    int ncomp_a, ncomp_b ;
    double coef_a, coef_ab ;
    double *DFCT_A, *DFCT_B ;

    ncomp_a = NCOMPTBL [ la ] ;
    ncomp_b = NCOMPTBL [ lb ] ;

    DFCT_A = DFCTTBL + IDXDFCT [ la ] ;
    DFCT_B = DFCTTBL + IDXDFCT [ lb ] ;

///fprintf ( stdout, "addr_fact: %d %d\n",
///          addr_fact [ 0 ], addr_fact [ 1 ] ) ;

///    if        ( inttype == 1 ) {
///        dint_to [ 0 ] = dint_from [ 0 ] ;
///        return 0 ;
///    ///
///    } else if ( inttype == 2 ) {
///        addr_a                = 0 ;
///        addr_from             = 0 ;
///        for ( ia = 0 ; ia < 3 ; ia++ ) {
///            ///dint_to [ addr_a ] = dint_from [ addr_from++ ] ;
///            dint_to [ addr_from ] = dint_from [ addr_from++ ] ;
///            addr_a            += addr_fact [ 0 ] ;
///        }
///        return 0 ;
///    ///
///    } else if ( inttype == 3 ) {
///        addr_a                    = 0 ;
///        addr_from                 = 0 ;
///        for ( ia = 0 ; ia < 3 ; ia++ ) {
///            addr_b                = addr_a ;
///            for ( ic = 0 ; ib < 3 ; ic++ ) {
//////fprintf ( stdout, "%d, %d\n", addr_a, addr_b ) ;
///                ///dint_to [ addr_c ] = dint_from [ addr_from++ ] ;
///                dint_to [ addr_from ] = dint_from [ addr_from++ ] ;
///                addr_b           += addr_fact [ 1 ] ;
///            }
///            addr_a               += addr_fact [ 0 ] ;
///        }
///        return 0 ;
///    ///
///    } else {
///    ///
        addr_from = 0 ;
        for ( ia = 0 ; ia < ncomp_a ; ia++ ) {
          coef_a =      1 * DFCT_A [ ia ] ;
          addr_a = ia * addr_fact [ 0 ] ;
          ///
          for ( ib = 0 ; ib < ncomp_b ; ib++ ) {
            coef_ab = coef_a * DFCT_B [ ib ] ;
            addr_ab = ib * addr_fact [ 1 ] + addr_a ;
            ///
            ///dint_to [ addr_ab ] = dint_from [ addr_from ] * coef_ab ;
            dint_to [ addr_from ] = dint_from [ addr_from ] * coef_ab ;
            ++addr_from ;
        } }
///    }

    return 0 ;
}

//////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////
int int1_save ( int inttype, int la, int lb, int *addr_fact,
                    double *dint_from, double *dint_to )
{
    save_and_mul_fact1 ( inttype, la, lb, addr_fact, dint_from, dint_to ) ;
    return 0 ;
}

